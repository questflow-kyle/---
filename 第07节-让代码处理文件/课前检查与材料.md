# 第7节：课前检查与材料

## 课前15分钟检查清单

课前15分钟到教室，按以下顺序逐项检查：

### 设备检查

- [ ] 投影仪开机，连接讲师电脑，画面正常
- [ ] 讲师电脑终端打开，字体大小调到后排能看清（建议18-20号字）
- [ ] 每台学员电脑开机，WSL 终端可正常打开
- [ ] 每台学员电脑 Python 可用：在终端输入 `python3 --version`，确认有输出
- [ ] 每台学员电脑 Claude Code 可用：在终端输入 `claude --version`，确认有输出

### 网络检查

- [ ] 教室 Wi-Fi 正常连接
- [ ] 在讲师电脑上测试 Claude Code 能正常响应：`claude "请说你好"`
- [ ] 在至少2台学员电脑上测试 Claude Code 能正常响应

### 练习环境准备

- [ ] 在**每台学员电脑**上创建本节课工作目录：
  ```bash
  mkdir -p ~/lesson07 && cd ~/lesson07
  ```

- [ ] 在**每台学员电脑**上创建测试文本文件 `sample.txt`：
  ```bash
  cat > ~/lesson07/sample.txt << 'EOF'
  学习编程就像学骑自行车。
  一开始可能会摔倒，但只要坚持练习就能学会。
  编程不需要你记住所有的语法。
  重要的是理解代码在做什么，能看懂就是第一步。
  现在有了AI工具，编程变得更容易了。
  我们要做的是学会和AI合作，让它帮我们写代码。
  EOF
  ```

- [ ] 在**每台学员电脑**上创建考勤数据文件 `attendance.csv`：
  ```bash
  cat > ~/lesson07/attendance.csv << 'EOF'
  姓名,日期,到岗时间,状态
  张三,2026-02-17,08:55,正常
  李四,2026-02-17,09:20,迟到
  王五,2026-02-17,08:50,正常
  赵六,2026-02-17,,缺勤
  钱七,2026-02-17,09:05,迟到
  张三,2026-02-18,09:30,迟到
  李四,2026-02-18,08:45,正常
  王五,2026-02-18,,缺勤
  赵六,2026-02-18,08:58,正常
  钱七,2026-02-18,09:00,正常
  张三,2026-02-19,08:50,正常
  李四,2026-02-19,09:10,迟到
  王五,2026-02-19,08:55,正常
  赵六,2026-02-19,09:25,迟到
  钱七,2026-02-19,08:48,正常
  EOF
  ```

- [ ] 确认文件创建成功：
  ```bash
  echo "--- sample.txt ---" && cat ~/lesson07/sample.txt
  echo "--- attendance.csv ---" && cat ~/lesson07/attendance.csv
  ```

### 备用代码准备

- [ ] 将下方"备用代码"部分的所有代码文件提前保存到讲师电脑的 `~/lesson07_backup/` 目录中

---

## 考勤 CSV 数据说明

以下是 attendance.csv 的数据设计，方便讲师理解数据规律：

| 姓名 | 2月17日 | 2月18日 | 2月19日 | 迟到总次数 |
|:---:|:---:|:---:|:---:|:---:|
| 张三 | 正常 | **迟到** 09:30 | 正常 | 1 |
| 李四 | **迟到** 09:20 | 正常 | **迟到** 09:10 | 2 |
| 王五 | 正常 | **缺勤** | 正常 | 0（迟到0次，缺勤1次） |
| 赵六 | **缺勤** | 正常 | **迟到** 09:25 | 1（迟到1次，缺勤1次） |
| 钱七 | **迟到** 09:05 | 正常 | 正常 | 1 |

- 总记录数：15条（5人 x 3天）
- 迟到记录：5条
- 缺勤记录：2条
- 正常记录：8条

**练习2的预期结果：** 筛选缺勤后应得到2条记录（赵六2月17日、王五2月18日）。

**练习3的预期结果：** 迟到次数统计应为：李四2次，张三/赵六/钱七各1次，王五0次。

---

## 备用代码

> 如果上课时 Claude Code 响应太慢或不可用，直接把以下代码复制到学员电脑上使用。

### 备用代码1：文本统计工具（word_count.py）

```python
# 文本文件统计工具

# 第一步：读取文件
with open("sample.txt", "r", encoding="utf-8") as f:
    content = f.read()

# 第二步：处理（统计）
lines = content.strip().split("\n")
line_count = len(lines)
char_count = len(content)
char_count_no_space = len(content.replace(" ", "").replace("\n", ""))

# 第三步：写入结果
result = f"""文件统计结果
==============
文件名：sample.txt
总行数：{line_count}
总字符数：{char_count}
字符数（不含空格和换行）：{char_count_no_space}
"""

with open("stats.txt", "w", encoding="utf-8") as f:
    f.write(result)

print(result)
print("统计结果已保存到 stats.txt")
```

讲师手动保存方式：
```bash
cat > ~/lesson07/word_count.py << 'PYEOF'
# 文本文件统计工具

# 第一步：读取文件
with open("sample.txt", "r", encoding="utf-8") as f:
    content = f.read()

# 第二步：处理（统计）
lines = content.strip().split("\n")
line_count = len(lines)
char_count = len(content)
char_count_no_space = len(content.replace(" ", "").replace("\n", ""))

# 第三步：写入结果
result = f"""文件统计结果
==============
文件名：sample.txt
总行数：{line_count}
总字符数：{char_count}
字符数（不含空格和换行）：{char_count_no_space}
"""

with open("stats.txt", "w", encoding="utf-8") as f:
    f.write(result)

print(result)
print("统计结果已保存到 stats.txt")
PYEOF
```

### 备用代码2：考勤筛选工具（attendance.py）

```python
import csv

# 第一步：读取 CSV 文件
late_records = []

with open("attendance.csv", "r", encoding="utf-8") as f:
    reader = csv.reader(f)
    header = next(reader)  # 跳过表头

    for row in reader:
        name = row[0]
        date = row[1]
        time = row[2]
        status = row[3]

        # 第二步：处理（筛选迟到记录）
        if status == "迟到":
            late_records.append({
                "姓名": name,
                "日期": date,
                "到岗时间": time
            })

# 第三步：写入报告
with open("late_report.txt", "w", encoding="utf-8") as f:
    f.write("考勤迟到报告\n")
    f.write("=" * 30 + "\n\n")

    for record in late_records:
        f.write(f"姓名：{record['姓名']}\n")
        f.write(f"日期：{record['日期']}\n")
        f.write(f"到岗时间：{record['到岗时间']}\n")
        f.write("-" * 20 + "\n")

    f.write(f"\n迟到总次数：{len(late_records)}\n")

print(f"筛选完成！共 {len(late_records)} 条迟到记录")
print("报告已保存到 late_report.txt")
```

讲师手动保存方式：
```bash
cat > ~/lesson07/attendance.py << 'PYEOF'
import csv

# 第一步：读取 CSV 文件
late_records = []

with open("attendance.csv", "r", encoding="utf-8") as f:
    reader = csv.reader(f)
    header = next(reader)  # 跳过表头

    for row in reader:
        name = row[0]
        date = row[1]
        time = row[2]
        status = row[3]

        # 第二步：处理（筛选迟到记录）
        if status == "迟到":
            late_records.append({
                "姓名": name,
                "日期": date,
                "到岗时间": time
            })

# 第三步：写入报告
with open("late_report.txt", "w", encoding="utf-8") as f:
    f.write("考勤迟到报告\n")
    f.write("=" * 30 + "\n\n")

    for record in late_records:
        f.write(f"姓名：{record['姓名']}\n")
        f.write(f"日期：{record['日期']}\n")
        f.write(f"到岗时间：{record['到岗时间']}\n")
        f.write("-" * 20 + "\n")

    f.write(f"\n迟到总次数：{len(late_records)}\n")

print(f"筛选完成！共 {len(late_records)} 条迟到记录")
print("报告已保存到 late_report.txt")
PYEOF
```

### 备用代码3：迟到次数统计（late_summary.py）

```python
import csv
from collections import Counter

# 读取 CSV
late_counter = Counter()

with open("attendance.csv", "r", encoding="utf-8") as f:
    reader = csv.reader(f)
    next(reader)  # 跳过表头

    for row in reader:
        name = row[0]
        status = row[3]

        if status == "迟到":
            late_counter[name] += 1

# 按迟到次数排序（从多到少）
sorted_records = late_counter.most_common()

# 写入汇总报告
with open("late_summary.txt", "w", encoding="utf-8") as f:
    f.write("迟到次数统计\n")
    f.write("=" * 20 + "\n\n")

    for name, count in sorted_records:
        f.write(f"{name}：{count}次\n")

    f.write(f"\n共 {len(sorted_records)} 人有迟到记录\n")

print("迟到次数统计：")
for name, count in sorted_records:
    print(f"  {name}：{count}次")
print(f"\n汇总已保存到 late_summary.txt")
```

讲师手动保存方式：
```bash
cat > ~/lesson07/late_summary.py << 'PYEOF'
import csv
from collections import Counter

# 读取 CSV
late_counter = Counter()

with open("attendance.csv", "r", encoding="utf-8") as f:
    reader = csv.reader(f)
    next(reader)  # 跳过表头

    for row in reader:
        name = row[0]
        status = row[3]

        if status == "迟到":
            late_counter[name] += 1

# 按迟到次数排序（从多到少）
sorted_records = late_counter.most_common()

# 写入汇总报告
with open("late_summary.txt", "w", encoding="utf-8") as f:
    f.write("迟到次数统计\n")
    f.write("=" * 20 + "\n\n")

    for name, count in sorted_records:
        f.write(f"{name}：{count}次\n")

    f.write(f"\n共 {len(sorted_records)} 人有迟到记录\n")

print("迟到次数统计：")
for name, count in sorted_records:
    print(f"  {name}：{count}次")
print(f"\n汇总已保存到 late_summary.txt")
PYEOF
```

---

## 备用教学方案

### 场景：Claude Code 完全不可用

如果整堂课 Claude Code 都无法使用：

1. **演示环节**：使用上方备用代码，直接复制到文件运行
2. **讲解方式不变**：逐行阅读的环节完全相同，只是代码来源从 Claude Code 变成讲师提供
3. **学员练习**：
   - 练习1：直接把备用代码2发给学员运行
   - 练习2：让学员在代码中手动把 `"迟到"` 改成 `"缺勤"`
   - 练习3：把备用代码3发给学员运行
4. **跟学员说**："今天网络有问题，AI 工具暂时用不了。但没关系，这节课的重点是**读懂代码和修改代码**，代码我直接给你们。"

### 场景：考勤 CSV 文件有问题

常见问题及解决：
- **文件编码乱码**：确保用 `encoding="utf-8"` 参数，如果还不行，让 Claude Code 重新生成 CSV
- **文件路径找不到**：统一让学员 `cd ~/lesson07` 再运行程序
- **CSV 格式错误（逗号缺失等）**：重新用上面的命令创建 attendance.csv

### 场景：个别学员电脑有问题

- 让该学员和旁边的同学共用一台电脑
- 梅杭俊优先协助排查该电脑问题

---

## 课前最后确认

| 确认项 | 状态 |
|:---|:---:|
| 投影可用 | [ ] |
| 所有电脑 Claude Code 可用 | [ ] |
| sample.txt 已创建（每台电脑） | [ ] |
| attendance.csv 已创建（每台电脑） | [ ] |
| 备用代码已就绪（讲师电脑） | [ ] |
| 讲师已通读教案一遍 | [ ] |
| 讲师能说清"读取→处理→写入"模式 | [ ] |

确认全部通过后，等学员到齐即可开课。
