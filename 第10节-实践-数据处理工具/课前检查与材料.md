# 第10节：课前检查与材料

> 本清单供讲师（沈林伟）和助教（梅杭俊）在上课前 30 分钟完成。
> 所有检查项完成后，在方框内打勾 `[x]`。

---

## 一、环境检查（课前30分钟，逐台电脑）

> 本节是实践课第2节。学员在第9节已经完整使用过一次Claude Code开发项目，环境理论上没有新变化。但仍需逐台确认，避免课上出问题。

### 每台电脑检查清单

对每一台学员电脑执行以下操作：

#### 1. WSL 终端正常
- [ ] 打开 Windows Terminal 或 WSL 终端
- [ ] 输入 `pwd`，确认能输出路径

#### 2. Python 环境可用
- [ ] 输入 `python3 --version`，确认输出版本号（`Python 3.10.x` 或更高）
- [ ] 输入 `python3 -c "import csv; print('csv模块正常')"`，确认输出"csv模块正常"

#### 3. Claude Code 可用
- [ ] 输入 `claude --version`，确认输出版本号
- [ ] 输入 `claude`，确认能正常启动
- [ ] 在 Claude Code 中输入"你好"，确认能收到回复
- [ ] 输入 `/exit` 退出

#### 4. API 配额检查
- [ ] 确认 API key 配置正确
- [ ] 预估本节课用量：每位学员约 8-15 次对话（含调试），10位学员约 80-150 次对话
- [ ] 如果使用共享 API key，确认余额充足

#### 5. 考勤数据文件已部署
- [ ] 在每台电脑上确认工作目录存在：
  ```bash
  ls ~/learning
  ```
- [ ] 将考勤数据CSV文件复制到每台电脑的 `~/learning/attendance.csv`
- [ ] 确认文件可读取：
  ```bash
  head -5 ~/learning/attendance.csv
  ```
  应看到CSV表头和前几行数据

### 检查记录表

| 电脑编号 | WSL | Python | Claude Code | API | 考勤CSV | 备注 |
|:---:|:---:|:---:|:---:|:---:|:---:|:---|
| 1 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 2 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 3 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 4 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 5 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 6 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 7 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 8 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 9 | [ ] | [ ] | [ ] | [ ] | [ ] | |
| 10 | [ ] | [ ] | [ ] | [ ] | [ ] | |

---

## 二、模拟考勤数据CSV

> 以下是完整的考勤数据文件内容。课前将此内容保存为 `attendance.csv`，复制到每台学员电脑的 `~/learning/` 目录下。
>
> 快捷操作：在讲师电脑上创建文件后，用 `scp` 或 U 盘复制到每台学员电脑。

### 创建方法

在终端执行以下命令，将CSV内容写入文件：

```bash
cat > ~/learning/attendance.csv << 'EOF'
姓名,日期,上班打卡,下班打卡,状态
张三,2026-01-02,08:55,18:05,正常
张三,2026-01-03,09:15,18:00,迟到
张三,2026-01-05,08:50,18:10,正常
张三,2026-01-06,,,缺勤
张三,2026-01-07,08:58,18:02,正常
张三,2026-01-08,09:20,18:00,迟到
张三,2026-01-09,08:45,20:30,加班
张三,2026-01-10,08:50,18:05,正常
张三,2026-01-12,08:55,18:00,正常
张三,2026-01-13,08:48,18:10,正常
李四,2026-01-02,08:50,18:00,正常
李四,2026-01-03,08:55,18:05,正常
李四,2026-01-05,08:45,18:00,正常
李四,2026-01-06,08:50,18:10,正常
李四,2026-01-07,08:58,18:00,正常
李四,2026-01-08,08:52,18:05,正常
李四,2026-01-09,08:48,18:00,正常
李四,2026-01-10,08:55,18:10,正常
李四,2026-01-12,08:50,18:00,正常
李四,2026-01-13,08:45,18:05,正常
王五,2026-01-02,09:10,18:00,迟到
王五,2026-01-03,08:55,18:05,正常
王五,2026-01-05,08:50,21:00,加班
王五,2026-01-06,08:48,18:10,正常
王五,2026-01-07,,,缺勤
王五,2026-01-08,,,缺勤
王五,2026-01-09,08:55,18:00,正常
王五,2026-01-10,09:05,18:05,迟到
王五,2026-01-12,08:50,19:30,加班
王五,2026-01-13,08:58,18:00,正常
EOF
```

### 数据说明

| 字段 | 含义 | 取值示例 |
|:---|:---|:---|
| 姓名 | 员工姓名 | 张三、李四、王五 |
| 日期 | 工作日日期 | 2026-01-02（周五）等 |
| 上班打卡 | 上班打卡时间（9:00前为正常） | 08:55、09:15 |
| 下班打卡 | 下班打卡时间（18:00后为正常） | 18:00、20:30 |
| 状态 | 当日考勤状态 | 正常/迟到/缺勤/加班 |

### 数据特点（设计意图）

- **张三**（10条记录）：有2次迟到、1天缺勤、1次加班（到20:30，加班2.5小时）——典型的普通员工
- **李四**（10条记录）：全部正常出勤，无迟到无缺勤无加班——全勤模范，用于测试全勤奖（L2）
- **王五**（10条记录）：有2次迟到、2天缺勤、2次加班（分别到21:00和19:30）——情况最复杂，用于测试各种计算逻辑

> **注意**：每人只有10天记录（非完整月份），是为了方便学员肉眼验证计算结果。如果学员问"为什么不是22天"，讲师回答："这是模拟数据，只选了10天方便大家检查结果对不对。实际工作中数据会更多，但程序处理方式一样。"

---

## 三、工资参数表（投影展示用）

> 课前准备好以下内容，上课时投影显示，全程保持可见。建议保存为一个文本文件，或者直接在终端用 `cat` 显示。

```
====================================================
              工 资 计 算 规 则
====================================================

基本月薪：4500元
每月标准工作天数：22天
日薪 = 4500 ÷ 22 ≈ 204.55元

---------- 加班费 ----------
工作日加班（18:00后）：
  每小时加班费 = 日薪 ÷ 8 × 1.5
              = 204.55 ÷ 8 × 1.5
              ≈ 38.35元/小时
  加班时长 = 下班打卡时间 - 18:00

---------- 扣款 ----------
迟到：每次扣50元（打卡时间晚于9:00）
缺勤：每天扣一天日薪（204.55元）

---------- 全勤奖（L2加分项）----------
当月无迟到 + 无缺勤 = 全勤奖200元

====================================================
```

---

## 四、讲师演示用材料

### 演示脚本预演

课前讲师需要自己完整跑一遍工具开发流程，确保投影演示时没有意外。

#### 预演步骤

1. 确认考勤CSV在讲师电脑的 `~/learning/attendance.csv`
2. 启动 Claude Code：
   ```bash
   cd ~/learning
   claude
   ```
3. 输入以下提示词：

**讲师演示用提示词：**

```
我有一个考勤数据文件 attendance.csv，在当前目录下。请帮我写一个Python程序 salary.py，功能是：

1. 读取 attendance.csv（编码UTF-8，包含表头：姓名,日期,上班打卡,下班打卡,状态）
2. 按员工姓名分组，统计每人的：
   - 正常出勤天数
   - 迟到次数
   - 缺勤天数
   - 加班总时长（下班打卡时间减去18:00，单位小时）
3. 按以下规则计算每人工资：
   - 基本月薪4500元，每月标准工作天数22天
   - 日薪 = 4500 / 22
   - 迟到一次扣50元
   - 缺勤一天扣一天日薪
   - 工作日加班费 = 加班小时数 × 日薪 / 8 × 1.5
4. 在终端打印每个人的工资明细，格式清晰易读
```

4. 等 Claude Code 生成代码并创建 `salary.py`
5. 退出 Claude Code，运行程序：
   ```bash
   python3 salary.py
   ```
6. 确认输出正确

#### 预期输出（参考）

```
====== 工资计算结果 ======

姓名：张三
  正常出勤：6天
  迟到次数：2次
  缺勤天数：1天
  加班时长：2.50小时
  基本工资：4500.00元
  加班费：+95.88元
  迟到扣款：-100.00元
  缺勤扣款：-204.55元
  应发工资：4291.33元

姓名：李四
  正常出勤：10天
  迟到次数：0次
  缺勤天数：0天
  加班时长：0.00小时
  基本工资：4500.00元
  加班费：+0.00元
  迟到扣款：-0.00元
  缺勤扣款：-0.00元
  应发工资：4500.00元

姓名：王五
  正常出勤：4天
  迟到次数：2次
  缺勤天数：2天
  加班时长：4.50小时
  基本工资：4500.00元
  加班费：+172.67元
  迟到扣款：-100.00元
  缺勤扣款：-409.09元
  应发工资：4163.58元
```

> **重要**：预演完成后，**删除讲师电脑上的 salary.py**（保留 attendance.csv），让课上演示时是"从零开始"的观感：
> ```bash
> rm ~/learning/salary.py
> ```

### 手动验证计算（讲师自己核对用）

以张三为例手动验证：
- 日薪 = 4500 / 22 = 204.545454...
- 加班时长：1月7日加班 20:30 - 18:00 = 2.5小时
- 加班费 = 2.5 × 204.55 / 8 × 1.5 = 2.5 × 38.35 = 95.88（约）
- 迟到扣款 = 2 × 50 = 100
- 缺勤扣款 = 1 × 204.55 = 204.55
- 应发 = 4500 + 95.88 - 100 - 204.55 = 4291.33（约）

以李四为例验证（全勤场景，L2用）：
- 无迟到、无缺勤、无加班
- 应发 = 4500 + 0 - 0 - 0 = 4500
- 如果加了全勤奖：4500 + 200 = 4700

---

## 五、投影内容汇总

课上需要投影的内容，建议提前准备好（可以保存为文本文件，课上用 `cat` 命令显示或直接打开）：

**投影1：数据处理四步走（环节二用）**
```
考勤数据处理四步走：
1. 读取考勤CSV数据
2. 按员工统计出勤情况（正常/迟到/缺勤/加班）
3. 按工资规则计算每人应发工资
4. 输出工资明细结果

通用模式：
输入数据 → 处理逻辑 → 输出结果
```

**投影2：工资参数表（全程保持显示）**

（见上方"三、工资参数表"内容）

**投影3：分层要求（环节三开始前展示）**
```
L1 能用：跑通工具，输入CSV，输出工资结果（终端打印）
L2 能调：修改计算规则（如加全勤奖200元）
L3 能交付：输出CSV文件 + 数据校验（检测异常记录）

先做L1，做完帮旁边的同学！
```

**投影4：常用命令速查（全程保留）**
```
cd ~/learning          进入工作目录
claude                 启动 Claude Code
/exit                  退出 Claude Code
python3 salary.py      运行工资计算程序
cat salary.py          查看代码内容
head -10 attendance.csv  看考勤数据前10行
pwd                    查看当前在哪个目录
ls                     查看目录下有什么文件
```

---

## 六、备用方案

### 备用方案A：个别电脑 Claude Code 无法使用

**症状**：`claude` 命令报错、API key 无效、网络不通等

**应对**：
1. 先尝试快速修复（2分钟内能解决就修）
2. 如果修不好，该学员与旁边同学共用一台电脑（两人一组，一人操作一人观察，轮流）
3. 课后单独帮该学员修复环境

### 备用方案B：全部电脑 Claude Code 无法使用（如网络中断、API服务故障）

**应对**：
1. 切换到网页版 Claude（https://claude.ai）或其他可用的网页版AI
2. 在网页版AI中输入同样的提示词，生成代码
3. 手动将代码复制到文件中：
   ```bash
   nano salary.py
   ```
   （将AI生成的代码粘贴进去，`Ctrl+O` 保存，`Ctrl+X` 退出）
4. 运行代码：`python3 salary.py`
5. 教学流程其余部分不变
6. 向学员解释："今天网络有点问题，我们换个方式，但方法是一样的——AI写代码，你运行。"

### 备用方案C：考勤CSV文件部署失败（部分电脑没有文件）

**应对**：
1. 用U盘临时复制
2. 或者让学员在Claude Code中直接说："请帮我创建一个模拟考勤数据文件 attendance.csv"——让AI生成测试数据也是一种学习
3. 最后手段：让学员和旁边有文件的同学共用

### 备用方案D：学员普遍卡住，进度严重落后

**症状**：开发15分钟后，超过一半学员L1还没跑通

**应对**：
1. 暂停独立开发，改为讲师带全班一起做
2. 讲师在投影上操作Claude Code，学员跟着做
3. 一步一步来：先一起输入提示词→一起看生成的代码→一起运行→一起看结果
4. 调整期望：本节课全班完成L1即可，L2/L3留到课后
5. 课后复盘原因（是提示词能力不足？还是环境问题？还是对上节课内容遗忘？）

### 备用方案E：课堂时间不够

**应对**：
- 参见教案中的"时间应急方案"
- 底线：确保每位学员至少完成L1——工具能跑通，能看到工资计算结果
- L2/L3的尝试可以留到课后

---

## 七、最终确认（课前5分钟）

以下是上课前最后5分钟的检查，确认一切就绪：

- [ ] 所有电脑环境检查完毕，问题已解决或有备用方案
- [ ] 每台电脑的 `~/learning/attendance.csv` 文件已部署并可读取
- [ ] 投影仪正常，字体大小合适（后排学员能看清终端内容）
- [ ] 讲师电脑已预演完整流程，确认提示词和输出结果正确
- [ ] 演示用的 `salary.py` 已删除（让课上演示看起来是从零开始）
- [ ] `attendance.csv` 文件保留在讲师电脑 `~/learning/` 目录下
- [ ] 投影内容已准备好（四步走、工资参数表、分层要求、命令速查）
- [ ] 网络连接稳定
- [ ] 梅杭俊已了解自己的巡场职责：
  - 重点帮助卡住的学员
  - 关注进度最慢的2-3位同学
  - 引导先完成的同学帮助未完成的
- [ ] 已确认上节课指定的回顾学员知道自己要上台讲
- [ ] 如有上节课遗留问题，已在课前修复

---

## 八、课后材料回收

课后需要确认/保留：

- [ ] 记录每位学员完成的等级（L1/L2/L3），填入教案的课后记录表
- [ ] 每位学员的 `~/learning` 目录下有 `salary.py`（或类似文件名），说明练习完成
- [ ] 指定下节课（第11节）开场回顾的学员
- [ ] 记录课上遇到的新问题，更新到教案 FAQ 中
- [ ] 如果有学员没完成L1，记录原因，下节课优先关注
